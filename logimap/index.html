<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöõ Logistics Map Generator</title>
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="logimap-layout.css">
    <link rel="stylesheet" href="logimap-components.css">
    <link rel="stylesheet" href="logimap-map.css">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header__left">
            <button class="sidebar-toggle" aria-label="Toggle sidebar">‚ò∞</button>
            <h1 class="header__title" data-translate="app-title">üöõ „É≠„Ç∏„Çπ„ÉÜ„Ç£„ÇØ„Çπ„Éû„ÉÉ„Éó„Ç∏„Çß„Éç„É¨„Éº„Çø„Éº</h1>
        </div>
        <div class="header__controls">
            <div class="language-switcher">
                <button class="language-btn active" onclick="switchLanguage('ja', this)" data-lang="ja">Êó•Êú¨Ë™û</button>
                <button class="language-btn" onclick="switchLanguage('en', this)" data-lang="en">English</button>
                <button class="language-btn" onclick="switchLanguage('zh', this)" data-lang="zh">‰∏≠Êñá</button>
            </div>
            <button class="btn btn--ghost theme-toggle" onclick="toggleDarkMode()" data-translate="toggle-theme">üåô „ÉÄ„Éº„ÇØ„É¢„Éº„Éâ</button>
            <button class="btn btn--primary export-btn" onclick="exportAsImage()" data-translate="export-image">üì∏ ÁîªÂÉèÂá∫Âäõ</button>
            <button class="btn btn--success export-btn" onclick="exportDataAsCSV()" data-translate="export-csv">üìä CSVÂá∫Âäõ</button>
        </div>
    </header>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Input Panel (Sidebar) -->
        <aside class="input-panel">
            <div class="panel-header">
                <h2 class="panel-title">Configuration Panel</h2>
                <div class="panel-controls">
                    <button class="btn btn--small" onclick="collapseAllSections()" title="Collapse All">üìÅ</button>
                    <button class="btn btn--small" onclick="expandAllSections()" title="Expand All">üìÇ</button>
                </div>
            </div>

            <!-- Facility1 Section -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="facility-1">ÊñΩË®≠1</span>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--small btn--success" onclick="addFacility1()" data-translate="add-facility">+ ËøΩÂä†</button>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                </div>
                <div class="section__content" id="facility1sContainer">
                    <!-- Facility1s will be added here -->
                </div>
            </section>

            <!-- Facility2 Section -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="facility-2">ÊñΩË®≠2</span>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--small btn--success" onclick="addFacility2()" data-translate="add-facility">+ ËøΩÂä†</button>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                </div>
                <div class="section__content" id="facility2sContainer">
                    <!-- Facility2s will be added here -->
                </div>
            </section>

            <!-- Facility3 Section -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="facility-3">ÊñΩË®≠3</span>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--small btn--success" onclick="addFacility3()" data-translate="add-facility">+ ËøΩÂä†</button>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                </div>
                <div class="section__content" id="facility3sContainer">
                    <!-- Facility3s will be added here -->
                </div>
            </section>

            <!-- Facility4 Section -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="facility-4">ÊñΩË®≠4</span>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--small btn--success" onclick="addFacility4()" data-translate="add-facility">+ ËøΩÂä†</button>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                </div>
                <div class="section__content" id="facility4sContainer">
                    <!-- Facility4s will be added here -->
                </div>
            </section>

            <!-- Facility5 Section -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="facility-5">ÊñΩË®≠5</span>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--small btn--success" onclick="addFacility5()" data-translate="add-facility">+ ËøΩÂä†</button>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                </div>
                <div class="section__content" id="facility5sContainer">
                    <!-- Facility5s will be added here -->
                </div>
            </section>

            <!-- Transport Configuration -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="transport-config">Ëº∏ÈÄÅË®≠ÂÆö</span>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <button class="btn btn--small btn--success" onclick="addTransportRoute()" data-translate="add-transport-route">+ Ëº∏ÈÄÅËøΩÂä†</button>
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                </div>
                <div class="section__content" id="transportContainer">
                    <!-- Transport routes will be added here -->
                </div>
            </section>

            <!-- Data Management -->
            <section class="section">
                <div class="section__header">
                    <span data-translate="data-management">„Éá„Éº„ÇøÁÆ°ÁêÜ</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
                <div class="section__content">
                    <div class="form-group">
                        <label class="form-label" data-translate="import-csv">CSV „Ç§„É≥„Éù„Éº„Éà</label>
                        <div class="file-upload">
                            <input type="file" id="csvFileInput" accept=".csv" onchange="importDataFromCSV(event)">
                            <label for="csvFileInput" class="file-upload-label" data-translate="select-csv-file">CSV„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</label>
                        </div>
                    </div>
                    <button class="btn btn--primary" onclick="downloadSampleTemplate()" style="width: 100%; margin-top: 1rem;" data-translate="download-template">üìã „Çµ„É≥„Éó„É´„ÉÜ„É≥„Éó„É¨„Éº„Éà</button>
                </div>
            </section>
        </aside>

        <!-- Map Panel -->
        <main class="map-panel">
            <div class="map-controls">
                <button class="map-control-btn" onclick="fitMapToContent()" title="Fit to Content">üîç</button>
                <button class="map-control-btn" onclick="resetMapZoom()" title="Reset Zoom">‚Üª</button>
                <button class="map-control-btn" onclick="centerMap()" title="Center Map">‚äπ</button>
            </div>
            
            <div class="map-display" id="mapDisplay">
                <div class="map-flow" id="mapFlow">
                    <!-- Map content will be generated here -->
                    <div class="location-column" id="facility1sColumn">
                        <!-- Facility1s will be added here -->
                    </div>
                    <div class="location-column" id="facility2sColumn">
                        <!-- Facility2s will be added here -->
                    </div>
                    <div class="location-column" id="facility3sColumn">
                        <!-- Facility3s will be added here -->
                    </div>
                    <div class="location-column" id="facility4sColumn">
                        <!-- Facility4s will be added here -->
                    </div>
                    <div class="location-column" id="facility5sColumn">
                        <!-- Facility5s will be added here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript Files -->
    <script src="logimap-layout.js"></script>
    <script src="logimap-core.js"></script>
</body>
</html>
