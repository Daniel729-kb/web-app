<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚢 AutomateCLP - Container Loading Planner with 3D Stacking</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="automateclp-specific.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🚢 AutomateCLP</h1>
            <p>Container Loading Planner with 3D Stacking Technology</p>
            <div class="header-controls">
                <button id="darkModeToggle" class="dark-mode-toggle" title="ダークモード切り替え">🌙</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Container Selection -->
                <div class="form-group">
                    <label for="containerType">コンテナタイプ</label>
                    <select id="containerType">
                        <option value="20ft">20ftコンテナ (5.898m × 2.352m × 2.385m 内寸)</option>
                        <option value="40ft">40ftコンテナ (12.032m × 2.350m × 2.385m 内寸)</option>
                        <option value="40HQ">40HQコンテナ (12.032m × 2.350m × 2.690m 内寸)</option>
                    </select>
                </div>

                <!-- 3D Stacking Toggle -->
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="enableStacking">
                        3D積み重ねを有効にする
                    </label>
                </div>

                <!-- Pallet Dimensions -->
                <div class="form-group">
                    <label for="palletLength">パレット長さ (cm)</label>
                    <input type="number" id="palletLength" placeholder="例: 110" min="1" max="300">
                </div>

                <div class="form-group">
                    <label for="palletWidth">パレット幅 (cm)</label>
                    <input type="number" id="palletWidth" placeholder="例: 110" min="1" max="300">
                </div>

                <!-- New 3D Fields -->
                <div class="form-group">
                    <label for="palletHeight">パレット高さ (cm)</label>
                    <input type="number" id="palletHeight" placeholder="例: 120" min="0" max="300">
                </div>

                <div class="form-group">
                    <label for="palletWeight">パレット重量 (kg)</label>
                    <input type="number" id="palletWeight" placeholder="例: 500" min="0" max="2000">
                </div>

                <!-- Stacking Constraints -->
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="canStackAbove" checked>
                        他のパレットの上に積み重ね可能
                    </label>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="canStackBelow" checked>
                        他のパレットの下に積み重ね可能
                    </label>
                </div>

                <div class="form-group">
                    <label for="palletQty">数量</label>
                    <input type="number" id="palletQty" value="1" min="1" max="100">
                </div>

                <div class="form-group">
                    <label for="clearanceValue">クリアランス (cm)</label>
                    <input type="number" id="clearanceValue" value="1" min="0" max="10" step="0.5">
                </div>

                <!-- Action Buttons -->
                <div class="form-group">
                    <button id="addPalletBtn" class="btn btn-primary">パレット追加</button>
                </div>

                <div class="form-group">
                    <button id="calculateBtn" class="btn btn-success">自動配置計算</button>
                </div>

                <div class="form-group">
                    <button id="testBtn" class="btn btn-info">テストケース実行</button>
                </div>

                <!-- Preset Buttons -->
                <div class="form-group">
                    <label>プリセットパレット</label>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-length="110" data-width="110" data-height="120" data-weight="800">110×110×120cm</button>
                        <button class="preset-btn" data-length="100" data-width="125" data-height="100" data-weight="600">100×125×100cm</button>
                        <button class="preset-btn" data-length="120" data-width="100" data-height="110" data-weight="700">120×100×110cm</button>
                    </div>
                </div>

                <!-- Pallet List -->
                <div class="form-group">
                    <label>追加済みパレット</label>
                    <div id="palletList" class="pallet-list"></div>
                </div>

                <!-- Container Info -->
                <div class="form-group">
                    <div id="containerInfo" class="container-info"></div>
                </div>

                <!-- Debug Section -->
                <div class="form-group">
                    <label>デバッグ機能</label>
                    <div class="debug-buttons">
                        <button id="debugStacking" class="btn btn-debug">積み重ねテスト</button>
                        <button id="debugGravity" class="btn btn-debug">重心計算</button>
                        <button id="debugLayout" class="btn btn-debug">レイアウト解析</button>
                        <button id="debugClear" class="btn btn-debug">クリア</button>
                    </div>
                    <div id="debugOutput" class="debug-output" style="display: none;"></div>
                </div>
            </div>

            <!-- Main Visualization Area -->
            <div class="main-visualization">
                <!-- Loading Animation -->
                <div id="loadingAnimation" class="loading-animation" style="display: none;">
                    <div class="spinner"></div>
                    <p>自動配置計算中...</p>
                </div>

                <!-- Manual Instructions -->
                <div id="manualInstructions" class="manual-instructions" style="display: none;">
                    <h3>📋 マニュアル調整手順</h3>
                    <ol>
                        <li><strong>ドラッグ&ドロップ:</strong> パレットを任意の位置に移動</li>
                        <li><strong>回転:</strong> ↻ボタンで90度回転</li>
                        <li><strong>削除:</strong> ✕ボタンでパレット削除</li>
                        <li><strong>3Dビュー:</strong> 積み重ね状況を3Dで確認</li>
                    </ol>
                </div>

                <!-- Export Button -->
                <button id="exportBtn" class="export-btn" style="display: none;">📸 レイアウトを画像として保存</button>

                <!-- Container View -->
                <div class="container-view">
                    <div id="containerFloor" class="container-floor"></div>
                </div>

                <!-- Legend -->
                <div id="legend" class="legend" style="display: none;"></div>

                <!-- Statistics -->
                <div id="stats" class="stats" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-value" id="inputPallets">0</div>
                        <div class="stat-label">入力パレット数</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="visiblePallets">0</div>
                        <div class="stat-label">表示パレット数</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="loadedPallets">0</div>
                        <div class="stat-label">コンテナ内パレット数</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="loadingRate">0%</div>
                        <div class="stat-label">積載率</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="efficiency">0%</div>
                        <div class="stat-label">面積効率</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="remainingArea">0.00m²</div>
                        <div class="stat-label">残り面積</div>
                    </div>
                </div>

                <!-- Unloaded Summary -->
                <div id="unloadedSummary" class="unloaded-summary" style="display: none;">
                    <h3>📦 未配置パレット一覧</h3>
                    <div class="unloaded-pallets"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Messages -->
    <div id="errorMessage" class="message error-message" style="display: none;"></div>
    <div id="successMessage" class="message success-message" style="display: none;"></div>

    <!-- Scripts -->
    <script src="automateclp.js"></script>
</body>
</html>
